<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>버블 팝 게임</title>
<style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .pink-text {
      color: #FF4081;  // 분홍색
    }

    h1 {
      position: absolute;
      top: 70px;  
      left: 50%;  
      transform: translateX(-50%);  
      z-index: 2;  
  }

    #gameContainer {
      position: relative;
      width: 300px;
      height: 400px;
      border: 2px solid #000;
      background-color: #fff;
    }

    .bubble {
      position: absolute;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background-color: #ff4081;
      cursor: pointer;
    }

    #gameOverContainer {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: none;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        margin-top: 20px;
        z-index: 2;  // gameContainer 위에 표시하기 위해 z-index를 높게 설정하세요.
      }

    #gameOverText {
      font-size: 24px;
      font-weight: bold;
    }

    #restartButton,#goBackButton {
      padding: 10px 20px;
      background-color: #4caf50;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }

    #gameDescriptionForm {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 200px;
      padding: 20px;
      background-color: #fff;
      border: 1px solid #000;
      text-align: center;
      z-index: 1; /* 폼이 게임 컨테이너 위에 나오도록 설정 */
    }

    #gameDescriptionText {
      margin-bottom: 20px;
    }

    #startButton {
      padding: 10px 20px;
      background-color: #4caf50;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }
</style>
<script>
  function goToChatbot() {
      // chatbot.html 페이지로 이동
      window.location.href = "chatbot";
  }
</script>
</head>
<body>
  <h1>버블 팝 게임!</h1>

  <div id="gameContainer"></div>

  <div id="gameDescriptionForm">
    <p id="gameDescriptionText"><strong>1분 내로 10개의 <br><span class="pink-text">분홍색</span> 동그라미를 눌러봐!</strong></p>
    <button id="startButton">알겠습니다!</button>
  </div>

  <div id="gameOverContainer">
    <p id="gameOverText">게임 종료!</p>
    <button id="restartButton">다시하기</button>
    <button onclick="goToChatbot()">챗봇으로 돌아가기</button>
  </div>

  <script>
    const gameContainer = document.getElementById('gameContainer');
    const gameDescriptionForm = document.getElementById('gameDescriptionForm');
    const startButton = document.getElementById('startButton');
    const gameOverContainer = document.getElementById('gameOverContainer');
    const restartButton = document.getElementById('restartButton');
    const goBackButton = document.getElementById('goBackButton');
    let bubbleCount = 0;
    let timeoutId;

    // 버블 생성 함수
    function createBubble() {
      const bubble = document.createElement('div');
      bubble.classList.add('bubble');

      // 랜덤한 위치에 버블 배치
      const randomX = Math.floor(Math.random() * (gameContainer.offsetWidth - 50));
      const randomY = Math.floor(Math.random() * (gameContainer.offsetHeight - 50));
      bubble.style.left = randomX + 'px';
      bubble.style.top = randomY + 'px';

      // 클릭 이벤트 처리
      bubble.addEventListener('click', () => {
        bubble.remove();
        bubbleCount++;

        if (bubbleCount >= 10) {
          endGame();
        }
      });

      gameContainer.appendChild(bubble);
    }

    // 일정 간격으로 버블 생성
    let bubbleInterval;

    // 게임 시작 함수
    function startGame() {
      bubbleCount = 0;
      gameContainer.style.pointerEvents = 'auto'; // 게임 화면 클릭 활성화
      gameOverContainer.style.display = 'none';
      clearTimeout(timeoutId); // 이전의 timeout 제거
      bubbleInterval = setInterval(createBubble, 1000);
      startTimer();
    }

    // 게임 종료 함수
    function endGame() {
      clearInterval(bubbleInterval);
      gameContainer.style.pointerEvents = 'none'; // 게임 화면 클릭 비활성화
      gameOverContainer.style.display = 'flex';
    }

    // 다시하기 버튼 클릭 시 게임 재시작
    restartButton.addEventListener('click', () => {
      gameContainer.innerHTML = '';
      startGame();
    });

    // 돌아가기 버튼 클릭 시 페이지 이동
    //goBackButton.addEventListener('click', () => {
     // window.location.href = '돌아갈_페이지_주소';
    //});

    // 타이머 시작 함수
    function startTimer() {
      timeoutId = setTimeout(() => {
        endGame();
      }, 60000); // 1분(60초) 후에 게임 종료
    }

    // 시작 버튼 클릭 시 게임 설명 폼 종료 및 게임 시작
    startButton.addEventListener('click', () => {
      gameDescriptionForm.style.display = 'none';
      startGame();
    });
  </script>
</body>
</html>