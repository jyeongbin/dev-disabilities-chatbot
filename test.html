<!DOCTYPE html>
<html>
<head>
    <title>카드 매치 게임</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: rgba(254,252,239);
            position: relative;
        }
        h1{
            text-align: center;
        }
        #game-instruction {
            position: absolute;
            top: 100px;
        }
        #intro, #game-board, #end-game {
            display: flex;
            flex-wrap: wrap;
            width: 320px;
            height: 320px;
            margin: auto;
            justify-content: center;
            align-items: center;
        }
        .card {
            width: 80px;
            height: 80px;
            margin: 5px;
            background-color: #4caf50;
            text-align: center;
            line-height: 80px;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 2em;
        }
        .matched {
            background-color: #f44336 !important;
            pointer-events: none;
        }
        #end-game {
            flex-direction: column;
        }
        #end-game button {
            margin: 5px;
        }
    </style>
</head>
<body>
    <div id="intro">
        <h1>화면의 카드 두 개를 골라 같은 짝을 맞추는 게임이야!</h1>
        <button onclick="startGame()" style="font-size: 1.5em;">알겠습니다!</button>
    </div>
    <h1 id="game-instruction" style="display: none;">카드 두 개를 맞춰봐</h1>
    <div id="game-board" style="display: none;"></div>
    <div id="end-game" style="display: none;">
        <h1>게임 종료</h1>
        <button onclick="restartGame()" class="end-game-button">다시하기</button>
        <button id="CancelButton" class="end-game-button">종료</button>
    </div>
    <script>
        const cards = ['🍎', '🍎', '🍌', '🍌', '🍓', '🍓', '🍇', '🍇'];
        const gameBoard = document.getElementById('game-board');
        let hasFlippedCard = false;
        let firstCard, secondCard;
        let lockBoard = false;
        // 게임판에 카드 배치
        cards.sort(() => 0.5 - Math.random());
        cards.forEach(card => {
            const cardElement = document.createElement('div');
            cardElement.classList.add('card');
            cardElement.dataset.card = card;
            cardElement.addEventListener('click', flipCard);
            gameBoard.appendChild(cardElement);
        });

        function startGame() {
            document.getElementById('intro').style.display = 'none';
            document.getElementById('game-board').style.display = 'flex';
            document.getElementById('game-instruction').style.display = 'block';
        }
        function flipCard() {
            if (lockBoard) return;
            this.innerText = this.dataset.card;
            if (!hasFlippedCard) {
                // 첫 번째 카드를 뒤집음
                hasFlippedCard = true;
                firstCard = this;
            } else {
                // 두 번째 카드를 뒤집음
                hasFlippedCard = false;
                secondCard = this;
                
                // 카드 쌍 체크
                if (firstCard.dataset.card === secondCard.dataset.card) {
                    // 매치 성공
                    firstCard.removeEventListener('click', flipCard);
                    secondCard.removeEventListener('click', flipCard);
                    firstCard.classList.add('matched');
                    secondCard.classList.add('matched');
        
                    // 모든 카드가 매치되었는지 확인
                    checkGameOver();
                } else {
                    // 매치 실패
                    lockBoard = true;
                    setTimeout(() => {
                        firstCard.innerText = '';
                        secondCard.innerText = '';
                        lockBoard = false;
                    }, 1000);
                }
            }
        }

        function checkGameOver() {
            const matchedCards = document.querySelectorAll('.matched');
            if (matchedCards.length === cards.length) {
                document.getElementById('game-board').style.display = 'none';
                document.getElementById('game-instruction').style.display = 'none';
                document.getElementById('end-game').style.display = 'flex';
            }
        }
        
        function restartGame() {
            location.reload();
        }
        
        function endGame() {
            window.close();
        }

        // 종료 버튼 클릭 시 페이지 이동
        CancelButton.addEventListener('click', () => {
            window.location.href = 'btn_chatbot';
        });


    </script>
</body>
</html>